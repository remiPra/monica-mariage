---
// -----------------------------------------------------------------------------
// SECTION 1 : IMPORTS (fusion des deux fichiers)
// -----------------------------------------------------------------------------
import { sanityClient } from "../../../sanityClient";
import { optimizeCloudinaryUrl } from "../../../lib/optimizeCloudinaryUrl";

// Composants de la page
import HeroSection from "../../../components/HeroSection.astro";
import FavoriButton from "../../../components/FavoriButton.astro";
import FavoriDrawer from "../../../components/FavoriDrawer.astro";

// Composants du Layout (maintenant intégrés)
import Header from "../../../components/Header.astro";
import FolatingButtonWhatsapp from "../../../components/FolatingButtonWhatsapp.astro";
import Footer from "../../../components/Footer.astro";
import AppointmentBar from "../../../components/AppointmentBar.astro";
import ImagePreloader from "../../../components/ImagePreloader.astro";
import "../../../styles/global.css";


// -----------------------------------------------------------------------------
// SECTION 2 : RÉCUPÉRATION DES DONNÉES (logique de votre page)
// -----------------------------------------------------------------------------
// 1) Définition des métadonnées et de l'URL canonique de la page
const pageMetadata = {
  title: "Robes de Mariée Princesse à Toulouse | Monica Mariage",
  description: "Robes de mariée princesse à Toulouse. Modèles volumineux et féeriques chez Monica Mariage pour réaliser votre rêve de conte de fées. Essayages personnalisés.",
  canonicalUrl: "https://monicamariage.com/robes-de-mariee/forme-princesse" // URL canonique spécifique à CETTE page
};

// 2) Récupération des robes depuis Sanity
const robesData = await sanityClient.fetch(`       
  *[_type == "robe"
    && category == "robes-de-mariee"
    && sousCategorie == "forme-princesse"]
  | order(order asc){
    _id,
    dressName,
    category,
    sousCategorie,
    "slug": slug.current,
    order,
    imagesCloudinary[]{ url, alt }
  }
`);

// 3) Mapping et optimisation des images
const robes = (robesData || []).map((robe) => ({
  ...robe,
  images: (robe.imagesCloudinary || []).map((img) => ({
    alt: img.alt,
    optimizedImages: {
      gallery: {
        desktop: optimizeCloudinaryUrl(img.url, false),
        tablet: optimizeCloudinaryUrl(img.url, false),
        mobile: optimizeCloudinaryUrl(img.url, "imageMobileGallery"),
      },
    },
  })),
}));

// 4) Préparation des URLs pour le préchargement
const preloadImageUrls = robes
  .slice(0, 4)
  .map((robe) => robe.images[0]?.optimizedImages.gallery.mobile)
  .filter(Boolean);

// 5) Préparation des données de collection pour le JSON-LD
const collectionData = {
  collectionName: "Robes de Mariée Princesse",
  url: pageMetadata.canonicalUrl,
  items: robes.map(robe => ({
    dressName: robe.dressName,
    slug: robe.slug,
    sousCategorie: robe.sousCategorie,
    image: robe.images[0]?.optimizedImages?.gallery?.mobile,
    url: `https://monicamariage.com/robes-de-mariee/${robe.sousCategorie}/${robe.slug}`
  }))
};

// 6) Préparation des Breadcrumbs
const breadcrumbs = [
  { name: "Accueil", url: "https://monicamariage.com" },
  { name: "Robes de mariée", url: "https://monicamariage.com/robes-de-mariee" },
  { name: "Forme Princesse", url: pageMetadata.canonicalUrl }
];


// -----------------------------------------------------------------------------
// SECTION 3 : LOGIQUE DU LAYOUT (intégrée ici)
// -----------------------------------------------------------------------------
const analyticsId = "G-H8RDXC45EX";

// Utilisation de l'URL canonique définie ci-dessus
const finalCanonicalUrl = pageMetadata.canonicalUrl;

// Fonction pour nettoyer le HTML des descriptions
function cleanDescription(desc) {
  if (!desc) return "";
  return desc.replace(/<[^>]*>/g, " ").replace(/\s+/g, " ").trim();
}

// Génération du JSON-LD pour la page de collection
const jsonLdData = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": collectionData.collectionName || pageMetadata.title,
  "description": cleanDescription(pageMetadata.description),
  "url": finalCanonicalUrl,
  "mainEntity": {
    "@type": "ItemList",
    "name": collectionData.collectionName,
    "numberOfItems": collectionData.items.length,
    "itemListElement": collectionData.items.map((item, index) => ({
      "@type": "ListItem",
      "position": index + 1,
      "item": {
  "@type": "Product",
  "name": item.dressName,
  "url": item.url,
  "image": item.image,
  "brand": { "@type": "Brand", "name": "Monica Mariage" },
  "category": "Robes de mariée",
  "offers": {
    "@type": "Offer",
    "availability": "https://schema.org/InStock",
    "priceCurrency": "EUR",
    "price": "Sur demande"
  }
}
    }))
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": breadcrumbs.map((crumb, index) => ({
      "@type": "ListItem",
      "position": index + 1,
      "name": crumb.name,
      "item": crumb.url
    }))
  }
};
---

<!-- 
  ==============================================================================
  SECTION 4 : STRUCTURE HTML (anciennement le Layout)
  ==============================================================================
-->
<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="google-site-verification" content="rq53avWhuLrrx3ABvRJ12myweeaU47sTzsWdbNOatsU" />
  
  <!-- Titre et description -->
  <title>{pageMetadata.title}</title>
  <meta name="description" content={pageMetadata.description} />
  
  <!-- URL canonique et Open Graph (utilisant finalCanonicalUrl) -->
  <link rel="canonical" href={finalCanonicalUrl} />
  <meta property="og:url" content={finalCanonicalUrl} />
  
  <!-- Open Graph -->
  <meta property="og:title" content={pageMetadata.title} />
  <meta property="og:description" content={pageMetadata.description} />
  <meta property="og:image" content="https://monicamariage.com/images/cover-robes.jpg" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Monica Mariage" />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={pageMetadata.title} />
  <meta name="twitter:description" content={pageMetadata.description} />
  <meta name="twitter:image" content="https://monicamariage.com/images/cover-robes.jpg" />
  
  <!-- Robots et autres meta -->
  <meta name="robots" content="index, follow" />
  <link rel="alternate" type="text/plain" href="/llms.txt" title="LLMs Optimization Data" />

  <!-- Preload des polices -->
  <link rel="preload" href="/fonts/great-vibes-v19-latin-regular.woff2" as="font" type="font/woff2" crossorigin />
  <link rel="preload" href="/fonts/cormorant-garamond-v19-latin-regular.woff2" as="font" type="font/woff2" crossorigin />

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  <!-- JSON-LD structuré -->
  {Object.keys(jsonLdData).length > 0 && (
    <script type="application/ld+json" set:html={JSON.stringify(jsonLdData, null, 2)} />
  )}

</head>
<body>
  <Header />

  <!-- 
    ==============================================================================
    SECTION 5 : CONTENU DE LA PAGE (votre contenu original)
    ==============================================================================
  -->

  <!-- Préchargement des images critiques -->
  {
    preloadImageUrls.map((url) => (
      <link rel="preload" href={url} as="image" fetchpriority="high" />
    ))
  }

  <main>
    <section
      style="margin-top: 120px;"
      class="py-1 bg-gradient-to-b from-white to-[#FDE9E6]"
    >
      <HeroSection
        title="Robes de Mariée Princesse et Évasée | Collection Toulouse"
        subtitle="Des modèles volumineux et féeriques pour un mariage digne d'un conte de fées"
        buttonText="Découvrir la collection"
        scrollTarget="#robes-collection"
        iconSrc="/image/iconerobe.png"
      />
      <div class="flex justify-center px-4" id="robes">
        <div
          class="grid mb-[100px] grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 max-w-6xl w-full"
        >
          {
            robes.map((robe, index) => (
              <a
                href={`/robes-de-mariee/${robe.sousCategorie}/${robe.slug}`}
                class="relative text-center overflow-hidden border-[#C5A880] cursor-pointer fade-in border rounded-2xl h-[500px] lg:h-[420px] shadow-md"
                data-index={index}
              >
                <FavoriButton
                  imageId={robe._id}
                  robeSlug={robe.slug}
                  sousCategorie={robe.sousCategorie}
                />
                {robe.images[0] ? (
                  <img
                    src={robe.images[0].optimizedImages.gallery.mobile}
                    alt={robe.images[0].alt || robe.dressName}
                    width="300"
                    height="500"
                    fetchpriority={index < 2 ? "high" : "auto"}
                    class="w-full absolute top-0 h-auto object-cover rounded hover:scale-105 transition-transform duration-300 z-[-1]"
                    loading={index < 4 ? "eager" : "lazy"}
                    decoding={index < 4 ? "sync" : "async"}
                  />
                ) : (
                  <div class="absolute inset-0 bg-gray-200 flex items-center justify-center">
                    <span class="text-gray-600">Image non disponible</span>
                  </div>
                )}

                <div class="absolute bottom-0 left-0 w-full text-center bg-gradient-to-t from-[#af7749] to-transparent p-6 rounded-b-2xl z-20">
                  <p class="text-white font-vibes text-4xl mb-4 drop-shadow-lg">
                    {robe.dressName.charAt(0).toUpperCase() +
                      robe.dressName.slice(1).toLowerCase()}
                  </p>
                  <button class="bg-[#C5A880] text-white font-semibold px-6 py-3 rounded-full shadow-lg hover:bg-[#A27E5D] transition-all">
                    Découvrir cette robe
                  </button>
                </div>
              </a>
            ))
          }
        </div>

        <script defer>
          document.addEventListener("DOMContentLoaded", () => {
            const observer = new IntersectionObserver((entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  entry.target.classList.add("active");
                  observer.unobserve(entry.target);
                }
              });
            });

            document.querySelectorAll(".fade-in").forEach((el) => {
              observer.observe(el);
            });
          });
        </script>

        <style>
          .fade-in {
            opacity: 0;
            transform: translateY(10px);
            transition:
              opacity 0.6s ease-in-out,
              transform 0.6s ease-in-out;
          }
          .fade-in.active {
            opacity: 1;
            transform: translateY(0);
          }
        </style>
      </div>
    </section>

    <section class="py-12 bg-gradient-to-b from-[#FDE9E6] to-white">
      <div class="container mx-auto px-4 max-w-6xl">
        <div class="flex flex-col items-center mb-8">
          <div class="flex justify-center mb-6">
            <div class="bg-white border-[#F0E6E2] w-32 h-32 border-2 rounded-full p-3 shadow-lg flex items-center justify-center">
              <img src="/icons/monica-mariage-icon6.webp" alt="Icône style princesse" class="w-full h-full object-contain rounded-full">
            </div>
          </div>
          <h2 class="font-vibes text-center text-4xl md:text-5xl text-[#af7749] mb-2">
            Style Princesse sur-Mesure
          </h2>
          <div class="flex items-center justify-center gap-4 mb-8">
            <span class="h-px w-12 bg-[#C5A880]"></span>
            <p class="text-[#8B7569] text-sm text-center font-medium">L'EXPERTISE MONICA MARIAGE</p>
            <span class="h-px w-12 bg-[#C5A880]"></span>
          </div>
        </div>
        <div class="max-w-4xl mx-auto text-center font-lora text-[#5F4B3F] leading-relaxed mb-12">
          <p class="text-base md:text-lg mb-8">
            Nos <strong>robes princesse sur-mesure</strong> incarnent le romantisme intemporel avec leurs silhouettes voluptueuses en <strong>tulle brodé</strong> et <strong>dentelles de Calais</strong>. Chaque création se personnalise entièrement lors de vos <strong>essayages privés</strong> dans notre showroom toulousain : ampleur du jupon, hauteur de taille, finitions broderies.
          </p>
          <p class="text-base md:text-lg mb-8">
            Notre expertise dans ce style féerique permet d'adapter chaque détail à votre morphologie : <strong>bustiers ajustés</strong> pour un maintien parfait, <strong>traînes personnalisables</strong> et <strong>ajustements jusqu'à la taille 44</strong>. De 750€ à 1850€, nos créations allient qualité couture et prix accessible.
          </p>
        </div>

        <!-- ***** DÉBUT DE LA SECTION ACCORDÉON RÉ-INTÉGRÉE ***** -->
        <div class="max-w-3xl mx-auto">
          <div class="space-y-4">
            
            <!-- Accordéon 1 - Notre approche sur-mesure -->
            <div class="bg-white rounded-lg overflow-hidden shadow-sm border border-[#F0E6E2] hover:shadow-md transition-all duration-300">
              <button class="w-full text-left px-6 py-5 text-[#5F4B3F] flex justify-between items-center accordion-trigger">
                <div class="flex items-center gap-4">
                  <img src="/icons/monica-mariage-icon4.webp" alt="Icône process" class="w-8 h-8 object-contain">
                  <span class="font-cormorant text-[#5F4B3F] font-medium text-lg">
                    Notre approche sur-mesure style princesse
                  </span>
                </div>
                <span class="w-8 h-8 flex items-center justify-center rounded-full bg-[#FDF8F7] border border-[#F0E6E2] text-[#af7749] transition-transform duration-300">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="5" x2="12" y2="19" />
                    <line x1="5" y1="12" x2="19" y2="12" />
                  </svg>
                </span>
              </button>
              <div class="accordion-content max-h-0 opacity-0 overflow-hidden transition-all duration-300">
                <div class="px-6 py-5 border-t border-[#F0E6E2] bg-[#FEFBFA]">
                  <ul class="max-w-2xl mx-auto text-sm md:text-base space-y-2">
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Rendez-vous découverte</strong> : présentation des modèles et échange sur vos souhaits</span>
                    </li>
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Essayages personnalisés</strong> : ajustements selon votre morphologie et préférences</span>
                    </li>
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Retouches incluses</strong> : pour un ajustement parfait le jour J</span>
                    </li>
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Accompagnement complet</strong> : de la conception à la livraison dans notre showroom</span>
                    </li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- Accordéon 2 - Matières et finitions -->
            <div class="bg-white rounded-lg overflow-hidden shadow-sm border border-[#F0E6E2] hover:shadow-md transition-all duration-300">
              <button class="w-full text-left px-6 py-5 text-[#5F4B3F] flex justify-between items-center accordion-trigger">
                <div class="flex items-center gap-4">
                  <img src="/icons/monica-mariage-icon3.webp" alt="Icône matières" class="w-8 h-8 object-contain">
                  <span class="font-cormorant text-[#5F4B3F] font-medium text-lg">
                    Matières et finitions de qualité
                  </span>
                </div>
                <span class="w-8 h-8 flex items-center justify-center rounded-full bg-[#FDF8F7] border border-[#F0E6E2] text-[#af7749] transition-transform duration-300">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="5" x2="12" y2="19" />
                    <line x1="5" y1="12" x2="19" y2="12" />
                  </svg>
                </span>
              </button>
              <div class="accordion-content max-h-0 opacity-0 overflow-hidden transition-all duration-300">
                <div class="px-6 py-5 border-t border-[#F0E6E2] bg-[#FEFBFA]">
                  <p class="text-base text-center mb-4 text-[#5F4B3F] leading-relaxed font-lora">
                    Nos robes princesse privilégient des matières nobles pour un rendu exceptionnel et un confort optimal.
                  </p>
                  <ul class="max-w-2xl mx-auto text-sm md:text-base space-y-2">
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Tulle de qualité supérieure</strong> : souple et volumineux pour l'effet princesse</span>
                    </li>
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Dentelles françaises</strong> : motifs délicats et finitions raffinées</span>
                    </li>
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Broderies et paillettes</strong> : pour apporter éclat et féerie</span>
                    </li>
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Doublures confortables</strong> : pour un port agréable toute la journée</span>
                    </li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- Accordéon 3 - Conseils morphologie -->
            <div class="bg-white rounded-lg overflow-hidden shadow-sm border border-[#F0E6E2] hover:shadow-md transition-all duration-300">
              <button class="w-full text-left px-6 py-5 text-[#5F4B3F] flex justify-between items-center accordion-trigger">
                <div class="flex items-center gap-4">
                  <img src="/icons/monica-mariage-icon1.webp" alt="Icône conseils" class="w-8 h-8 object-contain">
                  <span class="font-cormorant text-[#5F4B3F] font-medium text-lg">
                    Conseils selon votre silhouette
                  </span>
                </div>
                <span class="w-8 h-8 flex items-center justify-center rounded-full bg-[#FDF8F7] border border-[#F0E6E2] text-[#af7749] transition-transform duration-300">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="5" x2="12" y2="19" />
                    <line x1="5" y1="12" x2="19" y2="12" />
                  </svg>
                </span>
              </button>
              <div class="accordion-content max-h-0 opacity-0 overflow-hidden transition-all duration-300">
                <div class="px-6 py-5 border-t border-[#F0E6E2] bg-[#FEFBFA]">
                  <p class="text-base text-center mb-4 text-[#5F4B3F] leading-relaxed font-lora">
                    Le style princesse se décline pour sublimer toutes les morphologies avec nos conseils personnalisés.
                  </p>
                  <ul class="max-w-2xl mx-auto text-sm md:text-base space-y-2">
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Bustier ajusté</strong> : pour souligner la taille et structurer la silhouette</span>
                    </li>
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Décolleté personnalisé</strong> : selon vos préférences et morphologie</span>
                    </li>
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Ampleur modulable</strong> : volume de jupe adapté à votre style</span>
                    </li>
                    <li class="flex items-center gap-3">
                      <img src="/icons/monica-mariage-icon6.webp" alt="Puce" class="w-5 h-5 flex-shrink-0">
                      <span><strong>Confort garanti</strong> : ajustements pour un port parfait toute la journée</span>
                    </li>
                  </ul>
                </div>
              </div>
            </div>

          </div>

          <!-- Bouton d'action -->
          <div class="text-center mt-10">
            <a href="#contact" class="inline-flex items-center px-8 py-3 bg-[#af7749] text-white font-medium rounded-full hover:bg-[#9d6841] transition-colors duration-300 shadow-lg hover:shadow-xl">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9,22 9,12 15,12 15,22"></polyline>
              </svg>
              Réserver mon essayage
            </a>
          </div>
        </div>
        <!-- ***** FIN DE LA SECTION ACCORDÉON ***** -->

      </div>

      <!-- ***** SCRIPT ORIGINAL DE L'ACCORDÉON ***** -->
      <script>
      (function() {
        'use strict';
        
        function initAccordionSelfContained() {
          // Utilise un sélecteur plus large pour trouver les déclencheurs, peu importe où le script est placé.
          const accordionTriggers = document.querySelectorAll(".accordion-trigger");
          
          if (accordionTriggers.length === 0) {
            return;
          }

          accordionTriggers.forEach((trigger) => {
            // Empêche la double initialisation si le script se charge plusieurs fois
            if (trigger._accordionInitialized) return;
            trigger._accordionInitialized = true;

            trigger.addEventListener("click", function() {
              const expanded = this.getAttribute("aria-expanded") === "true";
              const content = this.nextElementSibling;
              const iconContainer = this.querySelector("span:last-child");

              // Fermer tous les autres accordéons
              document.querySelectorAll(".accordion-trigger").forEach((otherTrigger) => {
                if (otherTrigger !== this && otherTrigger.getAttribute("aria-expanded") === "true") {
                  otherTrigger.setAttribute("aria-expanded", "false");
                  const otherContent = otherTrigger.nextElementSibling;
                  const otherIconContainer = otherTrigger.querySelector("span:last-child");
                  
                  if (otherContent) {
                    otherContent.style.maxHeight = "0";
                    otherContent.style.opacity = "0";
                  }
                  if (otherIconContainer) {
                    otherIconContainer.style.transform = "rotate(0deg)";
                  }
                }
              });

              // Ouvrir ou fermer l'accordéon cliqué
              if (expanded) {
                this.setAttribute("aria-expanded", "false");
                if (content) {
                  content.style.maxHeight = "0";
                  content.style.opacity = "0";
                }
                if (iconContainer) {
                  iconContainer.style.transform = "rotate(0deg)";
                }
              } else {
                this.setAttribute("aria-expanded", "true");
                if (content) {
                  content.style.maxHeight = content.scrollHeight + "px";
                  content.style.opacity = "1";
                }
                if (iconContainer) {
                  iconContainer.style.transform = "rotate(0deg)";
                }
              }
            });
          });
        }

        // Exécuter le script une fois que le DOM est prêt
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', initAccordionSelfContained);
        } else {
          initAccordionSelfContained();
        }
      })();
      </script>
    </section>
  </main>
  
  <!-- 
    ==============================================================================
    SECTION 6 : FIN DE BODY (anciennement dans le Layout)
    ==============================================================================
  -->
  <FolatingButtonWhatsapp />
  <Footer />
  <AppointmentBar />
</body>

<!-- Script Google Analytics -->
<script define:vars={{ analyticsId }}>
  window.dataLayer = window.dataLayer || [];
  window.gtag = function () { dataLayer.push(arguments); };
  setTimeout(() => {
    const script = document.createElement("script");
    script.async = true;
    script.src = `https://www.googletagmanager.com/gtag/js?id=${analyticsId}`;
    document.head.appendChild(script);
    script.onload = () => {
      gtag("js", new Date());
      gtag("config", analyticsId);
    };
  }, 4000);
</script>
</html>